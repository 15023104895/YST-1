webpackJsonp([18],{Tg2t:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("gyMJ"),i={data:function(){return{visible:!1,dataForm:{merchantStoreIds:"",id:0,username:"",phone:"",role:"",description:""},allroleList:[],roleList:[],mdoptions:[],mdoptionsList:[]}},mounted:function(){this.getStore()},methods:{mendian:function(t){},gangwei:function(t){},getStore:function(){var t=this;o.a.store.storeAll({}).then(function(e){e.data&&e.data.storeList.length>0&&(t.mdoptions=e.data.storeList)})},handleClose:function(){this.$refs.dataForm.resetFields(),this.allroleList=[],this.roleList=[],this.mdoptionsList=[]},init:function(t){var e=this;this.dataForm.id=t||0,this.visible=!0,o.a.role.roleListAdd({}).then(function(a){a.data&&a.data.roleList.length>0&&(e.allroleList=a.data.roleList),e.dataForm.id&&o.a.adminUser.adminUserDetail({accountId:t}).then(function(t){if(t.data.account&&(e.dataForm.username=t.data.account.username,e.dataForm.phone=t.data.account.phone,e.dataForm.description=t.data.account.description),t.data.accountRoleList&&t.data.accountRoleList.length>0){var a=t.data.accountRoleList.map(function(t){return t.roleId});e.roleList=a}if(t.data.accountStoreList&&t.data.accountStoreList.length>0){var o=t.data.accountStoreList.map(function(t){return t.storeCode});e.mdoptionsList=o}})})},dataFormSubmit:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){var a={description:t.dataForm.description,roleId:t.roleList.join(","),storeCodes:t.mdoptionsList.join(",")};t.dataForm.id&&(a.accountId=t.dataForm.id),(t.dataForm.id?o.a.adminUser.adminUserEdit(a):o.a.adminUser.adminUserAdd(a)).then(function(e){"200"===e.code?t.$message({message:t.dataForm.id?"保存成功":"新增成功",type:"success",duration:1500,onClose:function(){t.visible=!1,t.$emit("refreshDataList")}}):t.$message.error(e.message)})}})}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],ref:"dialog__wrapper",attrs:{title:"角色分配","close-on-click-modal":!1,visible:t.visible,id:"add-or-update"},on:{"update:visible":function(e){t.visible=e},close:t.handleClose}},[a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,"label-width":"80px"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.dataFormSubmit()}}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{placeholder:"请填写用户名",disabled:!0},model:{value:t.dataForm.username,callback:function(e){t.$set(t.dataForm,"username",e)},expression:"dataForm.username"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请填写电话",disabled:!0},model:{value:t.dataForm.phone,callback:function(e){t.$set(t.dataForm,"phone",e)},expression:"dataForm.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"门店"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",placeholder:"选择B999则为全部门店",filterable:"","collapse-tags":""},on:{change:function(e){return t.mendian(t.mdoptionsList)}},model:{value:t.mdoptionsList,callback:function(e){t.mdoptionsList=e},expression:"mdoptionsList"}},t._l(t.mdoptions,function(t){return a("el-option",{key:t.code,attrs:{label:"["+t.code+"]"+t.name,value:t.code}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"description"}},[a("el-input",{attrs:{placeholder:"备注"},model:{value:t.dataForm.description,callback:function(e){t.$set(t.dataForm,"description",e)},expression:"dataForm.description"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"岗位"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",placeholder:"岗位只能选择一个",filterable:""},on:{change:function(e){return t.gangwei(t.roleList)}},model:{value:t.roleList,callback:function(e){t.roleList=e},expression:"roleList"}},t._l(t.allroleList,function(t){return a("el-option",{key:t.id,attrs:{label:"["+t.code+"]"+t.name,value:t.id}})}),1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.dataFormSubmit()}}},[t._v("确定")])],1)],1)},staticRenderFns:[]},r=a("C7Lr")(i,n,!1,null,null,null);e.default=r.exports}});
//# sourceMappingURL=18.de3918dd26b5f34a45cc.js.map