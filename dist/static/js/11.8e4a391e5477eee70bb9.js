webpackJsonp([11,18],{Tg2t:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("gyMJ"),i={data:function(){return{visible:!1,dataForm:{merchantStoreIds:"",id:0,username:"",phone:"",role:"",description:""},allroleList:[],roleList:[],mdoptions:[],mdoptionsList:[]}},mounted:function(){this.getStore()},methods:{mendian:function(e){},gangwei:function(e){},getStore:function(){var e=this;n.a.store.storeAll({}).then(function(t){t.data&&t.data.storeList.length>0&&(e.mdoptions=t.data.storeList)})},handleClose:function(){this.$refs.dataForm.resetFields(),this.allroleList=[],this.roleList=[],this.mdoptionsList=[]},init:function(e){var t=this;this.dataForm.id=e||0,this.visible=!0,n.a.role.roleListAdd({}).then(function(a){a.data&&a.data.roleList.length>0&&(t.allroleList=a.data.roleList),t.dataForm.id&&n.a.adminUser.adminUserDetail({accountId:e}).then(function(e){if(e.data.account&&(t.dataForm.username=e.data.account.username,t.dataForm.phone=e.data.account.phone,t.dataForm.description=e.data.account.description),e.data.accountRoleList&&e.data.accountRoleList.length>0){var a=e.data.accountRoleList.map(function(e){return e.roleId});t.roleList=a}if(e.data.accountStoreList&&e.data.accountStoreList.length>0){var n=e.data.accountStoreList.map(function(e){return e.storeCode});t.mdoptionsList=n}})})},dataFormSubmit:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){var a={description:e.dataForm.description,roleId:e.roleList.join(","),storeCodes:e.mdoptionsList.join(",")};e.dataForm.id&&(a.accountId=e.dataForm.id),(e.dataForm.id?n.a.adminUser.adminUserEdit(a):n.a.adminUser.adminUserAdd(a)).then(function(t){"200"===t.code?e.$message({message:e.dataForm.id?"保存成功":"新增成功",type:"success",duration:1500,onClose:function(){e.visible=!1,e.$emit("refreshDataList")}}):e.$message.error(t.message)})}})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],ref:"dialog__wrapper",attrs:{title:"角色分配","close-on-click-modal":!1,visible:e.visible,id:"add-or-update"},on:{"update:visible":function(t){e.visible=t},close:e.handleClose}},[a("el-form",{ref:"dataForm",attrs:{model:e.dataForm,"label-width":"80px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmit()}}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{placeholder:"请填写用户名",disabled:!0},model:{value:e.dataForm.username,callback:function(t){e.$set(e.dataForm,"username",t)},expression:"dataForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请填写电话",disabled:!0},model:{value:e.dataForm.phone,callback:function(t){e.$set(e.dataForm,"phone",t)},expression:"dataForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"门店"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",placeholder:"选择B999则为全部门店",filterable:"","collapse-tags":""},on:{change:function(t){return e.mendian(e.mdoptionsList)}},model:{value:e.mdoptionsList,callback:function(t){e.mdoptionsList=t},expression:"mdoptionsList"}},e._l(e.mdoptions,function(e){return a("el-option",{key:e.code,attrs:{label:"["+e.code+"]"+e.name,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"description"}},[a("el-input",{attrs:{placeholder:"备注"},model:{value:e.dataForm.description,callback:function(t){e.$set(e.dataForm,"description",t)},expression:"dataForm.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"岗位"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",placeholder:"岗位只能选择一个",filterable:""},on:{change:function(t){return e.gangwei(e.roleList)}},model:{value:e.roleList,callback:function(t){e.roleList=t},expression:"roleList"}},e._l(e.allroleList,function(e){return a("el-option",{key:e.id,attrs:{label:"["+e.code+"]"+e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},staticRenderFns:[]},r=a("C7Lr")(i,o,!1,null,null,null);t.default=r.exports},md3T:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Tg2t"),i=a("gyMJ"),o={name:"user",computed:{},components:{AddOrUpdate:n.default},data:function(){return{addOrUpdateVisible:!1,dataListLoading:!1,pageSize:10,pageIndex:1,totalPage:1,dataForm:{username:""},dataList:[]}},mounted:function(){this.getDataList()},methods:{addOrUpdateHandle:function(e){var t=this;this.addOrUpdateVisible=!0,this.$nextTick(function(){t.$refs.addOrUpdate.init(e)})},getDataList:function(){var e=this,t={username:this.dataForm.username,pageIndex:this.pageIndex,pageSize:this.pageSize};this.dataListLoading=!0,i.a.adminUser.adminUserList(t).then(function(t){"0000"===t.code?(t.data&&t.data.accountList&&(e.dataList=t.data.accountList),e.totalPage=t.paging.totalCount):e.$message.error(t.message),e.dataListLoading=!1})},sizeChangeHandle:function(e){this.pageSize=e,this.pageIndex=1,this.getDataList()},currentChangeHandle:function(e){this.pageIndex=e,this.getDataList()}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mod-user"},[a("el-form",{attrs:{inline:!0,model:e.dataForm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getDataList()}}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"用户名",clearable:""},model:{value:e.dataForm.username,callback:function(t){e.$set(e.dataForm,"username",t)},expression:"dataForm.username"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:function(t){return e.getDataList()}}},[e._v("查询")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",height:e.$store.state.documentClientIFRMAE}},[a("el-table-column",{attrs:{align:e.$store.state.common.align,type:"index",label:"序号",width:"50px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username","header-align":"center",align:e.$store.state.common.align,label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"realname","header-align":"center",align:e.$store.state.common.align,label:"真实姓名"}}),e._v(" "),a("el-table-column",{attrs:{"header-align":"center",align:e.$store.state.common.align,label:"角色"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.roles,function(t,n){return a("span",{key:n},[e._v("\n           "+e._s(t.roleName)+"\n        ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"phone","header-align":"center",align:e.$store.state.common.align,label:"手机号"}}),e._v(" "),a("el-table-column",{attrs:{"header-align":"center",align:e.$store.state.common.align,width:"150",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.addOrUpdateHandle(t.row.id)}}},[e._v("角色分配")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":[10,20,50,100],"page-size":e.pageSize,total:e.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.sizeChangeHandle,"current-change":e.currentChangeHandle}}),e._v(" "),e.addOrUpdateVisible?a("add-or-update",{ref:"addOrUpdate",on:{refreshDataList:e.getDataList}}):e._e()],1)},staticRenderFns:[]};var s=a("C7Lr")(o,r,!1,function(e){a("yrVp")},"data-v-30a55004",null);t.default=s.exports},yrVp:function(e,t){}});
//# sourceMappingURL=11.8e4a391e5477eee70bb9.js.map